<!DOCTYPE html><html><head>
      <title>Apuntes</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAfIAAsAAAAADDAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFZW7kosY21hcAAAAYAAAADTAAACjtP6ytBnbHlmAAACVAAAAxgAAAQ4zRtvlGhlYWQAAAVsAAAALwAAADYRwZsnaGhlYQAABZwAAAAcAAAAJAeKAzxobXR4AAAFuAAAABIAAAA8OGQAAGxvY2EAAAXMAAAAIAAAACAG5AfwbWF4cAAABewAAAAfAAAAIAEfAERuYW1lAAAGDAAAAVcAAAKFkAhoC3Bvc3QAAAdkAAAAYgAAAK2vz7wkeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkPsQ4gYGVgYOpk+kMAwNDP4RmfM1gxMjBwMDEwMrMgBUEpLmmMDgwVLy4xKzzX4chhrmK4QpQmBEkBwAZygyweJzFkr0NwjAQhZ+TEP6CRUfHBEwRUWaQTICyQbpMwRCskA5RUIONxG0RnnNpKAIV4qzPku/8c353ACYAYrIjCWCuMAh2ptf0/hiL3p/gyPUWa3osqlt0L1zu9r71z8dGrJRykFoauXQd932Lj5vhG+MjxGeYI8MKETObMpslf5EyP8tg+vHun5r539PvlvXzaVhRFVQDTPEWKVQR90KhnnC5Ek67vUKN4VuFasM/ldARj43CCkCsEjpJSoVVgRyU0GVSK6wUpFFCx8lFgX0BiXpRPQB4nE2TTWjcRhTH3xttpDhxN7uxPlp3u/FK7moRPixafRijNosxSw/LUsIwNcaEHPZggo/FmEKMCKWU4kNOOftQSlhE8alnH0Ix9BqWnHooPRrTQ0+mnu2bXTu2pPdGM9LM/6c3fwECTM4gBBMYQNqxzLrZAjqYSlqu2TAHZQA0/DQJH6FtzqGDnvbt4Ggwvzw/nL8EfH8kW0fsuRqhgWXZnY7M1picaUL7Du5BHeDzMIl83dAt016wH1qmvtSMo5R6YRJHTR//FXsff/nj/tc/5K9P5d+nP22+fFK5u7v3K39SW3y+OtDKO3L85vD09PD9z5X17a2N1g4tqk01RlqX7gyoEmnsWQtVr4rtZMmukEaFBZxzefkCn11cyKMLZgshRwgTYNoLNXCBz2ja7HvZG7hDpPSNfoo5vs0knK/9hb+rNpu+8kHPgk/Ao4kK3tWtTpSEtvkA9c+wE6UaUdwieNkaHg55tBEtRiEPw1s0+FtrtTcc9two2lhMknV7PZF/cs6+uUFTmpTGbEx7sQCPSLOttHS3GRltqp7SNzVSKzl6aWnZT/CX5k6/v9N3Hh8fHBwffJVjhrC6OgH5dkIt/tPsq+d/PD5Qz7G7efzq1THFjdZVPe/N6ulQ3JnDWSE5junsFsVIiFwL/htf1S5gJ3BfOcUxfHKLnzqpFpyfZ9cX+/5WB6a+Y0pHpzkNrYNVDwMsikK+y7WuLCRg/oFHkA8VT3rDg5ZnU6ktzzINymV0m74Xd5pfIGXyFeVEQSShkzqG7TBBa2OxVRKitLXv7h3uuftXnXq7lz2tZ/WnWa9dx9dCjDhHzmuVQATlmljr9dZErUydSo2Hbi/b1vXtrOeGCk2/8s3ZlO8+ueJT8BVlw5pGw2oYccdSiHHqx0RlabHqdNR9jAETl6PreJcPBnnfpTLnOQ8C3OV8AmQGzouV1iZdeb5SSIoVc8W8/kcDtksUH5FrU6/aqBqNWcMEzxG4DAQ14qRQhi9mWU0rzepKezbjfgCwQKxVYq5ajRgpRqy45CqwkJydcEkbTkvRz8P5/2ZpDTN4nGNgZGBgAOKb6v+/xvPbfGXgZmEAgeuB2kkI+v8bFgbmKiCXg4EJJAoAPyAKhQB4nGNgZGBg1vmvwxDDwgACQJKRARXwAwAzZQHQeJxjYQCCFAYGFgbSMQAcWACdAAAAAAAAAAwALgBgAIQAmADSAQgBIgE8AVABoAHeAfwCHHicY2BkYGDgZ7BgYGMAASYg5gJCBob/YD4DAA/hAWQAeJxlkbtuwkAURMc88gApQomUJoq0TdIQzEOpUDokKCNR0BuzBiO/tF6QSJcPyHflE9Klyyekz2CuG8cr7547M3d9JQO4xjccnJ57vid2cMHqxDWc40G4Tv1JuEF+Fm6ijRfhM+oz4Ra6eBVu4wZvvMFpXLIa40PYQQefwjVc4Uu4Tv1HuEH+FW7i1mkKn6Hj3Am3sHC6wm08Ou8tpSZGe1av1PKggjSxPd8zJtSGTuinyVGa6/Uu8kxZludCmzxMEzV0B6U004k25W35fj2yNlCBSWM1paujKFWZSbfat+7G2mzc7weiu34aczzFNYGBhgfLfcV6iQP3ACkSaj349AxXSN9IT0j16JepOb01doiKbNWt1ovippz6sVYYwsXgX2rGVFIkq7Pl2PNrI6qW6eOshj0xaSq9mpNEZIWs8LZUfOouNkVXxp/d5woqebeYIf4D2J1ywQB4nG3LOw6AIBAE0B384B+PAkgEa+QwNnYmHt+EpXSal5lkSBBnoP8oCFSo0aCFRIceA0ZMmLFAYSW88rmvtMUjG3RiQ9HvpfusM6zWNmtc5H/iPewha50tOt5PS/QBx2IeSwAA") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview .caso_estudio {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .ejercicio {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: center;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: space-between;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .galeria_imagenes {
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: row;
  }
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="llenguatge-sql">Llenguatge SQL </h1>
<h2 id="continguts">Continguts </h2>
<ol>
<li>Del disseny lògic al disseny físic</li>
<li>Crear Base de Dades</li>
<li>Taules i camps</li>
<li>Afegir i editar registres</li>
<li>Índexs</li>
<li>Restriccions</li>
<li>Taules a partir de consultes</li>
<li>Vistes</li>
</ol>
<h2 id="del-disseny-lògic-al-disseny-físic">Del disseny lògic al disseny físic </h2>
<div class="caso_estudio">
<p>El <strong>disseny físic</strong> és el procés de produir la descripció de la implementació de la base de dades en memòria secundària: estructures d'emmagatzematge i mètodes d'accés que garanteixin un accés eficient a les dades.</p>
</div> <!-- fi cas d'estudi -->
<p>Per dur a terme aquesta etapa, s'ha d'haver decidit quin és el SGBD que s'utilitzarà, ja que l'esquema físic s'adapta a ell.</p>
<p>En el nostre cas utilitzarem MySQL, i com que la seva sintaxi s'adapta en gran mesura a SQL ANSI, les ordres que utilitzarem seran molt similars en la resta de SGBD relacionals.</p>
<p>Quan arribem a aquest punt disposem de:</p>
<ul>
<li>descripció del sistema d'informació</li>
<li>l'esquema conceptual del model entitat-relació</li>
<li>l'esquema del diccionari de dades</li>
<li>l'esquema relacional del model relacional</li>
</ul>
<p>Mentre que en el disseny lògic s'especifica què es guarda, en el disseny físic s'especifica com es guarda. Per a això, el dissenyador ha de conèixer molt bé tota la funcionalitat del SGBD concret que s'hagi d'utilitzar i també el sistema informàtic sobre el qual aquest treballarà.</p>
<p>El disseny físic no és una etapa aïllada, ja que algunes decisions que es prenguin durant el seu desenvolupament, per exemple per millorar les prestacions, poden provocar una reestructuració de l'esquema lògic.</p>
<p>L'objectiu d'aquesta etapa és produir una descripció de la implementació de la base de dades en memòria secundària. Aquesta descripció inclou les estructures d'emmagatzematge i els mètodes d'accés que s'utilitzaran per aconseguir un accés eficient a les dades.</p>
<p>L'objectiu per tant és:</p>
<ul>
<li>Conèixer les <strong>utilitats o eines</strong> per a la definició d'informació en un SGBD.</li>
<li>Conèixer les <strong>ordres SQL</strong> per a la definició de dades.</li>
<li>Escollir <strong>el tipus de dada</strong> més adequat per a cada tipus d'informació.</li>
<li>Definir les <strong>estructures físiques</strong> d'emmagatzematge i implantar totes les <strong>restriccions</strong> reflectides en el disseny lògic (clau primària, clau alternativa, clau externa…).</li>
</ul>
<p>En aquesta unitat didàctica estudiarem les instruccions o ordres SQL del llenguatge de definició de dades (LDD) que permeten la creació de la nostra base de dades i que inclourà les taules amb els seus camps i índexs.</p>
<p>La primera fase del disseny lògic consisteix a traduir l'esquema lògic global en un esquema que es pugui implementar en el SGBD escollit. Per a això, és necessari conèixer tota la funcionalitat que aquest ofereix. Per exemple, el dissenyador haurà de saber:</p>
<ul>
<li>Si el sistema suporta la definició de claus primàries, claus externes i claus alternatives.</li>
<li>Si el sistema suporta la definició de dades requerides (és a dir, si es poden definir atributs com a no nuls).</li>
<li>Si el sistema suporta la definició de dominis.</li>
<li>Si el sistema suporta la definició de regles de negoci (és a dir, restriccions de cardinalitat o de càlcul).</li>
<li>Com es creen les taules base.</li>
</ul>
<div class="caso_estudio">
<p><strong>SINTAXI</strong><br>
Utilitzarem:</p>
<ul>
<li>paraules en majúscules per a les reservades de MySQL</li>
<li>paraules en minúscules per als noms dels nostres elements (taules, camps, índexs, …)</li>
<li>claudàtors per indicar un contingut opcional</li>
</ul>
</div> <!-- fi cas d'estudi -->
<p>Per poder connectar a la BD de MySQL utilitzarem dues eines:</p>
<ul>
<li><strong>Per línia d'ordres: <code>mysql.exe</code></strong></li>
<li><strong>Mitjançant l'aplicació web (AW) <code>phpMyAdmin</code></strong></li>
</ul>
<p>Les instruccions que executarem funcionen en les dues eines, encara que <strong>phpMyAdmin</strong> proporciona molta més informació de forma gràfica.</p>
<p>Un cop instal·lat <a href="https://www.apachefriends.org/es/download.html">xampp</a> obrirem el programa <strong><code>c:\xampp\xampp-control.exe</code></strong>.</p>
<p>Des d'aquesta eina posarem en marxa el servidor MySQL. A més, si utilitzarem <strong>phpMyAdmin</strong> haurem d'engegar també el servei web d'<strong>Apache</strong>.</p>
<p>Obrirem les dues eines alhora i comprovarem que en executar les instruccions en una d'elles, el seu resultat es pot veure en les dues.</p>
<p><img src=".img/3.1.png" alt="Panell de control de XAMPP"></p>
<hr>
<p>Per poder connectar amb <strong><code>mysql.exe</code></strong> obrirem una finestra d'ordres (CMD) i ens desplaçarem fins a la carpeta on tenim l'eina. Per connectar hem d'indicar que connectem amb l'usuari root que no té contrasenya:</p>
<div class="caso_estudio">
<p>C:&gt; <strong>cd \xampp\mysql\bin</strong><br>
C:\xampp\mysql\bin&gt; <strong>mysql -u root</strong></p>
</div> <!-- fi cas d'estudi -->
<hr>
<p>Per connectar amb l'Aplicació web phpMyAdmin obrirem un navegador i introduirem la URL: <a href="http://localhost/phpmyadmin">http://localhost/phpmyadmin</a></p>
<p>Per executar instruccions utilitzarem la pestanya SQL.</p>
<h2 id="crear-base-de-dades">Crear Base de Dades </h2>
<p>El primer que hem de fer és crear una base de dades.</p>
<p><strong>MySQL</strong> permet disposar de diverses bases de dades en cada instància que estiguem executant. Quan connectem a MySQL podem conèixer les bases de dades que hi ha creades amb la comanda:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-SHOW">SHOW</span> <span class="token keyword keyword-DATABASES">DATABASES</span><span class="token punctuation">;</span>
</code></pre><p>Per crear una base de dades nova utilitzarem la comanda:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-DATABASE">DATABASE</span> NomBD<span class="token punctuation">;</span>
</code></pre><p>Podem afegir altres paràmetres per si no són els que MySQL té per defecte:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-DATABASE">DATABASE</span> NomBD
<span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CHARACTER">CHARACTER</span> <span class="token keyword keyword-SET">SET</span> utf8
<span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-COLLATE">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
</code></pre><p>En <strong><code>my.ini</code></strong> es pot indicar en una variable l'<strong>ENGINE</strong> per defecte.</p>
<pre data-role="codeBlock" data-info="txt" class="language-txt txt"><code>[mysqld]
default-storage-engine = InnoDB
</code></pre><p>Per defecte ja té aquest valor i podem comprovar-ho a phpMyAdmin a la pestanya <em>Variables</em>.</p>
<p>Per eliminar una base de dades nova utilitzarem la comanda:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-DATABASE">DATABASE</span> NomBD<span class="token punctuation">;</span>
</code></pre><h2 id="taules-i-camps">Taules i camps </h2>
<p>Per crear una taula en el DF (Disseny Físic) partirem de l'esquema relacional, el diccionari de dades i la documentació de restriccions.</p>
<p>Hem de buscar la informació de restriccions d'alguns camps:</p>
<ul>
<li>
<p><strong>Restriccions per valor</strong><br>
Es defineixen al diccionari de dades. Aquestes restriccions poden estar referides a:</p>
<ul>
<li>Tipus de dada</li>
<li>Longitud</li>
<li>Domini de valors</li>
<li>Possibilitat d'estar buit (valor nul) o no</li>
<li>Valor únic (no repetit)</li>
</ul>
</li>
<li>
<p><strong>Restriccions d'existència</strong><br>
Es defineixen a l'esquema lògic i es detallen al diccionari de dades. Un camp que és clau externa d'una taula en la relació pot ser opcional (tenir valors nuls) o no.</p>
</li>
<li>
<p><strong>Restriccions de cardinalitat</strong><br>
Es defineixen a la documentació de restriccions.<br>
Exemple: Cardinalitat màxima definida = Un empleat en una empresa pertany a diversos departaments, però com a màxim a 4.</p>
</li>
<li>
<p><strong>Restriccions per camps calculats</strong><br>
Es defineixen al diccionari de dades. El valor d'un camp vindrà donat per una fórmula.</p>
</li>
</ul>
<p>Les restriccions per valor i d'existència tindran efecte en la pròpia creació de la taula, però les restriccions de cardinalitat i per camps calculats seran definides per <strong>disparadors (triggers)</strong> que comprovin o calculin les dades i així, garanteixin la seva integritat.</p>
<p>L'<strong>esquema relacional (model lògic) consta d'un conjunt de relacions (taules)</strong> i, per a cadascuna d'elles, es té:</p>
<ul>
<li>El <strong>nom de la relació</strong> (que es converteix en el DF en una taula)</li>
<li>La <strong>llista d'atributs</strong> entre parèntesis (que es converteixen en el DF en camps)</li>
<li>La <strong>clau primària i les claus externes</strong>, si en té.</li>
<li>Les <strong>regles d'integritat</strong> de les claus externes (valor obligatori o no)</li>
</ul>
<p>Al diccionari de dades es descriuen els atributs i, per a cadascun d'ells, es té:</p>
<ul>
<li>El seu domini: tipus de dades, longitud i restriccions de domini.</li>
<li>Si pot ser buit (és a dir, si admet valors nuls).</li>
<li>Si ha de tenir valor únic per a cada registre.</li>
<li>El valor per defecte (que és opcional).</li>
<li>Si és calculat, com es calcula el seu valor.</li>
<li>Si és enumerat, els valors que pot tenir (per exemple, SI i NO).</li>
</ul>
<p>Abans de començar necessitarem conèixer alguns tipus de dades de MySQL que utilitzarem:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Tipus de Dada</th>
<th style="text-align:left">Valors</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>VARCHAR</strong></td>
<td style="text-align:left">Cadena de caràcters</td>
</tr>
<tr>
<td style="text-align:left"><strong>INT</strong></td>
<td style="text-align:left">Número enter</td>
</tr>
<tr>
<td style="text-align:left"><strong>DECIMAL</strong></td>
<td style="text-align:left">Nombres decimals</td>
</tr>
<tr>
<td style="text-align:left"><strong>DATE</strong></td>
<td style="text-align:left">Data</td>
</tr>
<tr>
<td style="text-align:left"><strong>DATETIME o TIMESTAMP</strong></td>
<td style="text-align:left">Data i hora</td>
</tr>
<tr>
<td style="text-align:left"><strong>ENUM</strong></td>
<td style="text-align:left">Conjunt de valors</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title"><strong>Referències</strong></p>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/data-types.html">Tipus de dades a MySQL – Documentació oficial</a></p>
</div>
<p>Per crear una taula utilitzarem la comanda sql <strong><code>CREATE TABLE</code></strong> reduïda:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> NomTaula <span class="token punctuation">(</span>
        Camp1<span class="token punctuation">,</span>
        Camp2<span class="token punctuation">,</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        CampN
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>La sintaxi per definir un <strong>camp</strong> en la instrucció anterior és:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code>nom_col TIPO
<span class="token punctuation">[</span><span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword keyword-DEFAULT">DEFAULT</span> valor_per_defecte<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword keyword-AUTO_INCREMENT">AUTO_INCREMENT</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword keyword-PRIMARY">PRIMARY</span><span class="token punctuation">]</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword keyword-COMMENT">COMMENT</span> <span class="token string">'string'</span><span class="token punctuation">]</span>
</code></pre><div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p>Crear una taula anomenada <strong>articulos</strong> amb els següents camps:</p>
<ul>
<li><strong><code>codigo</code></strong> com a cadena de 4 caràcters</li>
<li><strong><code>descripcion</code></strong> com a cadena de 100 caràcters</li>
<li><strong><code>precio</code></strong> com un real amb 2 decimals.</li>
</ul>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
        codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title"><strong>Referències</strong></p>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/create-table.html">CREATE TABLE a MySQL – Documentació oficial</a></p>
</div>
<div class="ejercicio">
<h3 id="white_check_mark-exercici-1">✅ Exercici 1 </h3>
<p>Partint de l'esquema lògic, crea la taula de proveïdors de la nostra comunitat autònoma següent:<br>
<strong>proveedores</strong>(cod_prov, localidad, nombre, província)<br>
El diccionari de dades (només amb restriccions de valor) és:</p>
<table>
<thead>
<tr>
<th style="text-align:left">CAMP</th>
<th style="text-align:left">TIPUS</th>
<th style="text-align:left">LONGITUD</th>
<th style="text-align:left">CARACTERÍSTIQUES</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>cod_prov</strong></td>
<td style="text-align:left">Cadena</td>
<td style="text-align:left">3</td>
<td style="text-align:left">Clau Primària<br>No Nul</td>
</tr>
<tr>
<td style="text-align:left"><strong>localitat</strong></td>
<td style="text-align:left">Cadena</td>
<td style="text-align:left">100</td>
<td style="text-align:left">Nul</td>
</tr>
<tr>
<td style="text-align:left"><strong>nom</strong></td>
<td style="text-align:left">Cadena</td>
<td style="text-align:left">100</td>
<td style="text-align:left">No nul<br>Únic<br>Clau Alternativa</td>
</tr>
<tr>
<td style="text-align:left"><strong>província</strong></td>
<td style="text-align:left">Enumerat</td>
<td style="text-align:left"></td>
<td style="text-align:left">'Alacant', 'València', 'Castelló'</td>
</tr>
</tbody>
</table>
</div> <!-- fi exercici -->
<p><strong>Solució:</strong></p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> proveedores <span class="token punctuation">(</span>
        cod_prov    <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
        localidad   <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
        nombre         <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">,</span>
        provincia   <span class="token keyword keyword-ENUM">ENUM</span><span class="token punctuation">(</span><span class="token string">'Alicante'</span><span class="token punctuation">,</span><span class="token string">'Valencia'</span><span class="token punctuation">,</span><span class="token string">'Castellón'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="ejercicio">
<h3 id="white_check_mark-exercici-2">✅ Exercici 2 </h3>
<p>A XAMPP-MySQL mitjançant l'utilitat <strong><code>mysql.exe</code></strong> executa les instruccions anteriors.</p>
<p>Entra a <strong>phpMyAdmin</strong> i comprova amb l'assistent visual l'estructura de la taula i crea una altra anomenada <strong>proveedores2</strong> amb la mateixa informació amb l'eina gràfica.<br>
Prement a la pestanya <em>Insertar</em>, afegeix registres a la taula <strong>proveedores2</strong>.</p>
<p>Comprova amb el botó <em>Examinar</em> les dades introduïdes. Comprovaràs que apareix un botó <em>Editar</em> i un altre <em>Borrar</em> que afecta a cada registre.</p>
</div> <!-- fi exercici -->
<p>Amb la comanda <strong><code>DROP TABLE</code></strong> podem eliminar una taula.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 2</p>
<p><strong>Eliminar una taula</strong><br>
Eliminar la taula <strong>proveedores</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-TABLE">TABLE</span> proveedores<span class="token punctuation">;</span>
</code></pre></div>
<p>Amb la comanda <strong><code>RENAME TABLE</code></strong> podem canviar el nom d'una taula.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 3</p>
<p><strong>Canviar el nom a una taula</strong><br>
Canviar el nom de la taula <strong>proveedores</strong> per <strong>distribuidores</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-RENAME">RENAME</span> <span class="token keyword keyword-TABLE">TABLE</span> proveedores <span class="token keyword keyword-TO">TO</span> distribuidores<span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Afegir un camp a una taula existent</strong><br>
Un cop creada una taula, és possible que necessitem afegir, modificar o eliminar algun camp existent. Per a això utilitzarem la comanda <strong><code>ALTER TABLE</code></strong>. Aquesta comanda admet moltes variants.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 4</p>
<p><strong>Afegir camps a una taula</strong><br>
Afegir el camp <strong><code>descuento</code></strong>, de tipus enter amb 3 dígits i sense acceptar valors nuls, després del camp <strong><code>precio</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos
<span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-COLUMN">COLUMN</span> descuento <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword keyword-AFTER">AFTER</span> precio<span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Modificar un camp a una taula existent</strong><br>
Hi ha dues formes de canviar un camp d'una taula:</p>
<ul>
<li>
<p><strong>Amb l'opció <code>MODIFY</code></strong>. Es pot canviar la definició del camp però no el nom.</p>
<div class="admonition danger">
<p class="admonition-title">Perill</p>
<p>La instrucció <strong><code>ALTER TABLE</code></strong> amb l'opció <strong><code>MODIFY</code></strong> fa que es perdin les dades que hi havia a la columna canviada.</p>
</div>
</li>
<li>
<p><strong>Amb l'opció <code>CHANGE</code></strong>. Es pot canviar tant la definició com el nom del camp. Amb aquesta opció es preserven els canvis.</p>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Exemple 5</p>
<p><strong>Modificar la definició dels camps d'una taula</strong><br>
Modificar el camp <strong><code>descuento</code></strong> de manera que ara passi a tenir 4 dígits.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos
<span class="token keyword keyword-MODIFY">MODIFY</span> <span class="token keyword keyword-COLUMN">COLUMN</span> descuento <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Exemple 6</p>
<p><strong>Modificar la definició dels camps d'una taula</strong><br>
Modificar el camp <strong><code>descompte</code></strong> de manera que ara passi a tenir 4 dígits i es digui <strong><code>dto</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos CHANGE descuento dto <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Eliminar un camp d'una taula existent</strong><br>
Amb la instrucció <strong><code>ALTER TABLE</code></strong> i l'opció <strong><code>DROP COLUMN</code></strong> podem eliminar un camp d'una taula.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 7</p>
<p><strong>Eliminar camps d'una taula</strong><br>
Eliminar el camp dto de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos
<span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-COLUMN">COLUMN</span> dto<span class="token punctuation">;</span>
</code></pre></div>
<div class="ejercicio">
<h3 id="white_check_mark-exercici-3">✅ Exercici 3 </h3>
<p>A XAMPP-MySQL mitjançant l'utilitat <strong><code>mysql.exe</code></strong> executa les instruccions anteriors.</p>
<p>Entra a <strong>phpMyAdmin</strong> i comprova amb l'assistent visual l'estructura de la taula <strong>articulos</strong>.<br>
Insereix registres i comprova si pots editar la informació.<br>
Per què en <em>Examinar</em> no apareixen els botons <em>Editar</em> i <em>Borrar</em>?</p>
</div> <!-- fi exercici -->
<h2 id="afegir-i-editar-registres">Afegir i editar registres </h2>
<h3 id="insert">INSERT </h3>
<p>La comanda <strong><code>INSERT</code></strong> insereix noves files en una taula existent. Hi ha dues maneres d'inserir registres en una taula:</p>
<ul>
<li>
<p><strong>Amb la clàusula <code>VALUES</code></strong><br>
El format de la comanda és <strong><code>INSERT ... VALUES</code></strong> i insereix files basant-se en els valors especificats explícitament.</p>
<ul>
<li>
<p><strong>Inserir un registre</strong>: la sintaxi per inserir un registre és la següent:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> nomTaula <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span> col_name2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span>valor_col1<span class="token punctuation">,</span> valor_col2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p><strong>Inserir diversos registres</strong>: la sintaxi per inserir diversos registres és la següent:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> nomTaula <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span> colname2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword keyword-VALUES">VALUES</span>
      <span class="token punctuation">(</span>valor1_col1<span class="token punctuation">,</span> valor1_col2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>valor2_col1<span class="token punctuation">,</span> valor2_col2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token punctuation">(</span>valorn_col1<span class="token punctuation">,</span> valorn_col2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
</ul>
</li>
<li>
<p><strong>Amb sentència <strong><code>SELECT</code></strong></strong><br>
El format de la comanda és <strong><code>INSERT ... SELECT</code></strong> i insereix files seleccionades d'una altra taula o taules.<br>
La sintaxi per consultar els registres d'una taula és:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-SELECT">SELECT</span> col_name1<span class="token punctuation">,</span> col_name2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword keyword-FROM">FROM</span> nomTaula
<span class="token punctuation">[</span><span class="token keyword keyword-WHERE">WHERE</span> condicio<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><p>La sintaxi per <strong>inserir registres des d'una consulta SELECT</strong> és la següent:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> nomTaula2 <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span> col_name2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword keyword-SELECT">SELECT</span> col_name1<span class="token punctuation">,</span> col_name2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token keyword keyword-FROM">FROM</span> nomTaula1
<span class="token punctuation">[</span><span class="token keyword keyword-WHERE">WHERE</span> condicio<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></li>
</ul>
<blockquote>
<p>✋ <strong>Important</strong><br>
Si hi ha camps a la taula que no s'especifiquen a la instrucció <strong><code>INSERT</code></strong>, se li assignarà el valor que s'hagi indicat en la seva creació per defecte (<strong><code>DEFAULT</code></strong>) i en cas contrari serà <strong><code>NULL</code></strong>.</p>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p><strong>Inserir valors en taules</strong><br>
Insereix un teclat i un ratolí sense fils a la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> articulos <span class="token punctuation">(</span>codigo<span class="token punctuation">,</span> descripcion<span class="token punctuation">,</span> precio<span class="token punctuation">)</span> <span class="token keyword keyword-VALUES">VALUES</span>
        <span class="token punctuation">(</span><span class="token string">'0001'</span><span class="token punctuation">,</span> <span class="token string">'TECLAT SENSE FILS'</span><span class="token punctuation">,</span> <span class="token number">10.45</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">'0002'</span><span class="token punctuation">,</span> <span class="token string">'RATOLÍ SENSE FILS'</span><span class="token punctuation">,</span> <span class="token number">7.95</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h2 id="update">UPDATE </h2>
<p>La sentència <strong><code>UPDATE</code></strong> actualitza columnes de files existents d'una taula amb nous valors.</p>
<p>La clàusula <strong><code>SET</code></strong> indica les columnes a modificar i els valors que han de prendre.</p>
<p>La clàusula <strong><code>WHERE</code></strong>, si es proporciona, especifica quines files han de ser actualitzades. Si no s'especifica, seran actualitzades totes elles.</p>
<p>La sintaxi per actualitzar registres és:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-UPDATE">UPDATE</span> nomTaula
<span class="token keyword keyword-SET">SET</span> camp <span class="token operator">=</span> valor        
<span class="token punctuation">[</span><span class="token keyword keyword-WHERE">WHERE</span> condicio<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><p>A la clàusula <strong><code>SET</code></strong> utilitzarem <em>valor</em> per indicar una cadena, número, data, …</p>
<div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p><strong>Actualització de registres</strong><br>
Actualitzar el nom d'una persona identificada pel DNI.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-UPDATE">UPDATE</span> personas
<span class="token keyword keyword-SET">SET</span> nombre <span class="token operator">=</span> <span class="token string">'Joan López'</span>
<span class="token keyword keyword-WHERE">WHERE</span> dni <span class="token operator">=</span> <span class="token string">'21555666'</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Exemple 2</p>
<p><strong>Actualització de registres</strong><br>
Augmentar l'edat d'una persona pel seu aniversari.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-UPDATE">UPDATE</span> personas
<span class="token keyword keyword-SET">SET</span> edad <span class="token operator">=</span> edad <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword keyword-WHERE">WHERE</span> dni <span class="token operator">=</span> <span class="token string">'21555666'</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Exemple 3</p>
<p><strong>Actualització de registres</strong><br>
Augmentar el preu de tots els articles un 5%.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-UPDATE">UPDATE</span> articulos
<span class="token keyword keyword-SET">SET</span> precio <span class="token operator">=</span> precio <span class="token operator">+</span> precio <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Perill</p>
<p>Compte amb la clàusula <strong><code>UPDATE</code></strong> ja que si no posem cap condició (clàusula <strong><code>WHERE</code></strong>) s'actualitzaran tots els registres de la taula.</p>
</div>
<h2 id="delete">DELETE </h2>
<p>La sentència <strong><code>DELETE</code></strong> elimina les columnes d'una taula que compleixin la condició donada per la clàusula, i retorna el nombre de registres esborrats. Sense clàusula <strong><code>WHERE</code></strong> elimina tots els registres.</p>
<p>La sintaxi per eliminar registres és:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-FROM">FROM</span> nomTaula
<span class="token punctuation">[</span><span class="token keyword keyword-WHERE">WHERE</span> condicio<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="admonition danger">
<p class="admonition-title">Perill</p>
<p>Compte amb la clàusula <strong><code>DELETE</code></strong> ja que si no posem cap condició (clàusula <strong><code>WHERE</code></strong>) s'eliminaran tots els registres de la taula.</p>
</div>
<h2 id="índexs">Índexs </h2>
<p>Els índexs són estructures que es creen a les Bases de Dades per poder controlar la integritat i realitzar cerques de manera més eficient.</p>
<p>En crear una taula podem crear diversos índexs amb les següents paraules reservades:</p>
<ul>
<li><strong>KEY o PRIMARY KEY</strong>: un índex únic per al camp de clau primària.</li>
<li><strong>UNIQUE</strong>: un índex únic per a un camp que sigui clau alternativa.</li>
<li><strong>INDEX</strong>: un índex amb valors repetits per optimitzar cerques sobre un camp.</li>
</ul>
<p>Els índexs es poden crear en el moment de la creació de la taula afegint files amb l'opció <strong><code>INDEX</code></strong> després de la definició dels camps.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> nomTaula <span class="token punctuation">(</span>
    Camp1<span class="token punctuation">,</span>
    Camp2<span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    CampN    
    <span class="token keyword keyword-INDEX">INDEX</span> <span class="token punctuation">[</span>nomIndex<span class="token punctuation">]</span> <span class="token punctuation">(</span>campI<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Es crea un índex sobre el <strong>camp I</strong> i, opcionalment, li podem donar un nom (millor deixar que el SGBD li doni un nom automàticament).</p>
<div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p><strong>Índexs en taules</strong><br>
Creació de la taula <strong>articulos</strong> i definició d'un índex sobre el camp <strong><code>categoría</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">,</span>
    categoria <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-INDEX">INDEX</span> <span class="token punctuation">(</span>categoria<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Afegir índexs</strong><br>
Si desitgéssim crear un índex amb valors repetits quan la taula ja existeix, utilitzaríem la comanda següent:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> nom_index <span class="token keyword keyword-ON">ON</span> nomTaula <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span>…<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Si desitgéssim crear un índex amb valors únics quan la taula ja existeix, utilitzaríem la comanda següent:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span> <span class="token keyword keyword-INDEX">INDEX</span> nom_index <span class="token keyword keyword-ON">ON</span> nomTaula <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span>…<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Per afegir una clau primària a una taula que no en té, podem fer-ho amb la instrucció <strong><code>ALTER TABLE</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> nomTaula
<span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>col_name1<span class="token punctuation">,</span>…<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p><strong>Eliminar índexs</strong></p>
<p>Per eliminar un índex haurem de saber el seu nom.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-INDEX">INDEX</span> nomIndex <span class="token keyword keyword-ON">ON</span> nomTaula<span class="token punctuation">;</span>
</code></pre><p>Quan es defineix una clau primària automàticament es crea un índex únic sobre el camp (o camps) que defineixen aquesta clau.<br>
Podem eliminar l'índex associat a la clau primària amb la instrucció <strong><code>ALTER TABLE</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> nomTaula
<span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">;</span>
</code></pre><h2 id="restriccions">Restriccions </h2>
<h3 id="restricció-de-camp-clau">Restricció de camp clau </h3>
<p>La necessitat d'identificar un registre de manera única ens obliga a crear una restricció pel camp clau, ja que aquest no podrà ser nul ni tenir valors duplicats.</p>
<p>De fet, no es poden editar les dades d'una taula que no tingui clau primària, encara que sí que es poden inserir registres.</p>
<p>Les claus (primàries i foranes) poden ser:</p>
<ul>
<li><strong>Simples</strong>: formades per un sol camp</li>
<li><strong>Compostes</strong>: formades per la concatenació de diversos camps</li>
</ul>
<p><strong>Definir la clau primària en el moment de crear la taula</strong><br>
Aquesta es pot declarar a la mateixa fila en què es defineix un camp (només és vàlid si el camp és simple) o després de la definició dels camps en una línia independent (vàlid per a tot tipus de claus, simples o compostes).</p>
<div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p><strong>Restriccions camp clau taules</strong><br>
Crear la taula <strong>articulos</strong> i definir el camp <strong><code>codigo</code></strong> com a clau primària.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">-- La clau primària es defineix al costat del camp</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- La clau primària es defineix al final en una fila independent</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>codigo<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Eliminar la clau primària</strong><br>
Es pot dur a terme amb la instrucció <strong><code>ALTER TABLE</code></strong> combinada amb l'opció <strong><code>DROP</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 2</p>
<p><strong>Restriccions camp clau taules</strong><br>
Eliminar la clau primària de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Afegir la clau primària a una taula existent</strong><br>
Es pot afegir la clau primària amb posterioritat a la creació de la taula amb la instrucció <strong><code>ALTER TABLE</code></strong> combinada amb l'opció <strong><code>ADD</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 3</p>
<p><strong>Restriccions camp clau taules</strong><br>
Afegir la clau primària definida sobre el camp <strong><code>codigo</code></strong> a la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>codigo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Claus compostes</strong><br>
Ja hem dit anteriorment que una clau és composta si està formada per la concatenació de diversos camps.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 4</p>
<p><strong>Restriccions camp clau taules</strong><br>
Crear la taula <strong>revision_itv</strong> on es guardaran les revisions d'ITV dels vehicles. La clau primària està formada per la <strong><code>matricula</code></strong> i la <strong><code>fecha</code></strong> de matriculació del vehicle.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> revision_itv <span class="token punctuation">(</span>
    matricula <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    fecha <span class="token keyword keyword-DATE">DATE</span><span class="token punctuation">,</span>
    estado <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>matricula<span class="token punctuation">,</span> fecha<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Es podria haver creat la taula en primer lloc i a continuació afegir la clau primària.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 4b</p>
<p><strong>Restriccions camp clau taules</strong></p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">-- Crear la taula</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> revision_itv <span class="token punctuation">(</span>
    matricula <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    fecha <span class="token keyword keyword-DATE">DATE</span><span class="token punctuation">,</span>
    estado <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- Afegir la clau primària</span>
<span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> revision_itv <span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>matricula<span class="token punctuation">,</span> fecha<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3 id="restricció-de-camp-obligatori">Restricció de camp obligatori </h3>
<p>Quan un camp no pot tenir valors nuls, diem que és un camp obligatori. En el nostre exemple indicarem la descripció com a camp obligatori perquè cap article tingui la descripció buida.</p>
<p><strong>Definir camp obligatori en crear la taula</strong><br>
Un camp obligatori es defineix amb l'opció <strong><code>NOT NULL</code></strong> al costat del camp.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 5</p>
<p><strong>Restriccions camp obligatori</strong><br>
Crear la taula <strong>articulos</strong> i definir el camp <strong><code>descripcion</code></strong> com a obligatori.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Eliminar la restricció de camp obligatori</strong><br>
Per eliminar la restricció de camp obligatori utilitzem la instrucció <strong><code>ALTER TABLE</code></strong> amb l'opció <strong><code>CHANGE</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 6</p>
<p><strong>Restriccions camp obligatori</strong><br>
Eliminar la restricció de camp obligatori del camp <strong><code>descripcion</code></strong> de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos CHANGE descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Afegir la restricció de camp obligatori en una taula que ja existeix</strong><br>
També es fa amb la instrucció <strong><code>ALTER TABLE</code></strong> amb l'opció <strong><code>CHANGE</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 7</p>
<p><strong>Restriccions camp obligatori</strong><br>
Afegir la restricció de camp obligatori del camp <strong><code>descripcion</code></strong> de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos CHANGE descripcion descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre></div>
<h3 id="restricció-de-camp-amb-valors-únics">Restricció de camp amb valors únics </h3>
<p>Quan un camp no pot tenir valors repetits, diem que és un camp únic. Quan es defineix un camp únic automàticament es crea un índex sobre aquest amb valors únics.</p>
<p><strong>Definir un camp únic en crear la taula</strong><br>
Es pot fer amb l'opció <strong><code>UNIQUE</code></strong> al costat del camp sobre el qual es defineix.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 8</p>
<p><strong>Restriccions camp únic</strong><br>
Definir una restricció única sobre el camp <strong><code>descripcion</code></strong> en el moment de la creació de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">,</span>
    precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Eliminar la restricció de camp únic</strong><br>
Es duu a terme amb la instrucció <strong><code>ALTER TABLE</code></strong> combinada amb l'opció <strong><code>DROP</code></strong>. La restricció s'elimina esborrant l'índex associat que es crea quan es defineix aquesta.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 9</p>
<p><strong>Restriccions camp únic</strong><br>
Eliminar la restricció única definida sobre el camp <strong><code>descripcion</code></strong> de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-INDEX">INDEX</span> descripcion<span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Afegir la restricció de camp únic en una taula que ja existeix</strong><br>
Es duu a terme amb la instrucció <strong><code>ALTER TABLE</code></strong> combinada amb l'opció <strong><code>ADD</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 10</p>
<p><strong>Restriccions camp únic</strong><br>
Afegir una restricció única sobre el camp <strong><code>descripcion</code></strong> de la taula <strong>articulos</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">(</span>descripcion<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3 id="restricció-de-camp-per-clau-externa">Restricció de camp per clau externa </h3>
<p>Com ja hem vist en els esquemes lògics relacionals obtinguts dels esquemes conceptuals, existeixen claus externes que contenen valors de la clau primària d'una altra taula amb la qual es relacionen.</p>
<p>En un esquema que té localitats i províncies, on indiquem en cada localitat de quina província és, podríem tenir les següents taules:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> provincias <span class="token punctuation">(</span>
        cod_prov <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
        provincia <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token punctuation">(</span>
    cod_loc <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    localidad <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cod_provincia <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p><strong>Crear clau externa en crear la taula</strong><br>
La clau externa es pot definir en el moment de crear la taula declarant-la després de la definició dels camps de la taula.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 11</p>
<p><strong>Restriccions camp per clau externa</strong><br>
Crear la taula <strong>localidades</strong> definint una clau forana sobre el camp <strong><code>cod_provincia</code></strong> que faci referència a la taula <strong>provincias</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token punctuation">(</span>
    cod_loc <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    localidad <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cod_provincia <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>cod_província<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> provincias <span class="token punctuation">(</span>cod_prov<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Quan creem una relació, i per tant una clau externa, es creen dos elements a la BD:</p>
<ul>
<li><strong>Índex</strong>: un índex (en el nostre exemple <strong>INDEX(cod_provincia)</strong>) amb el nom del camp per a la clau externa amb valors repetits, ja que pot ser una relació 1 → N i per tant haurà de repetir valors. En el nostre exemple, diverses localitats tindran la mateixa província.</li>
<li><strong>Relació</strong>: s'assigna a la relació un nom per defecte format pel nom de la taula, el literal <em>ibfk</em> i un número. En el cas anterior serà <strong><code>localidades_ibfk1</code></strong>.</li>
</ul>
<p>Si volem donar-li un nom nosaltres utilitzarem la clàusula <strong><code>CONSTRAINT</code></strong>:</p>
<div class="admonition example">
<p class="admonition-title">Exemple 12</p>
<p><strong>Restriccions camp per clau externa</strong><br>
Exemple equivalent a l'anterior en què s'ha donat el nom <strong><code>provincias_cod_prov</code></strong> a la restricció de clau externa.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token punctuation">(</span>
    cod_loc <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    localidad <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cod_provincia <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-CONSTRAINT">CONSTRAINT</span> provincias_cod_prov <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>cod_provincia<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> provincias <span class="token punctuation">(</span>cod_prov<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>D'aquesta manera s'utilitzarà el valor de <strong><code>CONSTRAINT</code></strong> tant per a l'índex com per a la relació.</p>
<p><strong>Eliminar la restricció de clau externa</strong><br>
S'utilitza la instrucció <strong><code>ALTER TABLE</code></strong> en combinació amb l'opció <strong><code>DROP</code></strong> per a aquest propòsit. Si hem definit la restricció amb una clàusula <strong><code>CONSTRAINT</code></strong> l'utilitzarem.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 13</p>
<p><strong>Restriccions camp per clau externa</strong><br>
Eliminar la restricció de clau externa de nom <strong><code>provincias_cod_prov</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> provincias_cod_prov<span class="token punctuation">;</span>
</code></pre></div>
<p>En cas de no haver utilitzat la clàusula <strong><code>CONSTRAINT</code></strong> en la definició de la restricció llavors l'eliminarem indicant el nom que se li ha donat per defecte.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 14</p>
<p><strong>Restriccions camp per clau externa</strong><br>
Eliminar la restricció de clau externa definida anònimament en la taula <strong>localidades</strong>. Sabem que només hi ha aquesta restricció de clau externa.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> localidades_ibkf_1<span class="token punctuation">;</span>
</code></pre></div>
<p>També haurem de decidir si desitgem eliminar l'índex existent o no. En cas de desitjar eliminar-lo haurem d'indicar-ho amb la instrucció corresponent segons hàgim indicat <strong><code>CONSTRAINT</code></strong> o no. Si no hem utilitzat l'opció <strong><code>CONSTRAINT</code></strong> llavors l'índex té el mateix nom que el camp sobre el qual es defineix.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 15</p>
<p><strong>Restriccions camp per clau externa</strong><br>
Eliminar l'índex associat a la clau externa definida en la taula <strong>localidades</strong> sobre el camp <strong><code>cod_província</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">-- Se li havia donat un nom a l'índex.</span>
<span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-INDEX">INDEX</span> provincias_cod_prov<span class="token punctuation">;</span>
<span class="token comment">-- No se li havia donat un nom a l'índex.</span>
<span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-INDEX">INDEX</span> cod_provincia<span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Afegir la restricció de clau externa a una taula existent</strong><br>
S'utilitza la instrucció <strong><code>ALTER TABLE</code></strong> en combinació amb l'opció <strong><code>ADD</code></strong> per a aquest propòsit.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 16</p>
<p><strong>Restriccions camp per clau externa</strong><br>
Afegir una clau externa sobre el camp <strong><code>cod_provincia</code></strong> de la taula <strong>localidades</strong> que faci referència a la taula <strong>provincias</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">-- Sense clàusula CONSTRAINT</span>
<span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-ADD">ADD</span> 
<span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>cod_provincia<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> provincias <span class="token punctuation">(</span>cod_prov<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- Amb clàusula CONSTRAINT</span>
<span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-CONSTRAINT">CONSTRAINT</span> provincias_cod_prov
<span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>cod_provincia<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> provincias <span class="token punctuation">(</span>cod_prov<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3 id="restricció-per-esborrat-o-actualització-duna-clau-externa">Restricció per esborrat o actualització d'una clau externa </h3>
<p>Una de les accions més importants per mantenir la integritat en una base de dades és identificar correctament l'acció a realitzar quan eliminem o actualitzem el valor de la clau externa d'un registre.</p>
<p>En el cas de buidar el camp <strong><code>localidades.cod_provincia</code></strong> podem dur a terme diverses accions:</p>
<ul>
<li>
<p><strong>RESTRICT</strong>: És el valor per defecte. El servidor MySQL rebutjarà l'operació d'eliminació o actualització per a la taula pare (províncies) si hi ha un valor de clau externa relacionat en la taula referenciada (localitats), és a dir, no es pot a províncies eliminar un registre o canviar la seva clau, si existeixen localitats d'aquesta província.</p>
</li>
<li>
<p><strong>NO ACTION</strong>: Pertany al SQL estàndard. En MySQL és equivalent a RESTRICT. Alguns sistemes de base de dades tenen verificacions diferides, i NO ACTION és un control diferit. En MySQL, les restriccions de clau externa es verifiquen immediatament, per la qual cosa NO ACTION és el mateix que RESTRICT.</p>
</li>
<li>
<p><strong>SET NULL</strong>: Si en la taula pare (províncies) s'elimina un registre o s'actualitza la seva clau, si hi ha algun valor de clau externa relacionat en la taula referenciada (localitats) s'actualitzarà el valor a NULL.<br>
Si especifiqueu una acció SET NULL, assegureu-vos que no heu declarat les columnes en la taula secundària com a NOT NULL.</p>
</li>
<li>
<p><strong>CASCADE</strong>:</p>
<ul>
<li>En <strong>esborrar</strong>, si en la taula pare (províncies) s'elimina un registre, s'eliminaran també tots els registres de la taula referenciada (localitats) que tingui aquest valor en la seva clau externa.</li>
<li>En <strong>actualitzar</strong>, si en la taula pare (províncies) s'actualitza la clau d'un registre, s'actualitzaran també tots els registres de la taula referenciada (localitats) que tingui aquest valor en la seva clau externa amb el nou valor.</li>
</ul>
<p>Per indicar aquestes accions <strong>afegirem a la sentència <code>FOREIGN KEY</code> alguna de les següents clàusules</strong>:</p>
<ul>
<li><strong><code>ON DELETE RESTRICT</code></strong></li>
<li><strong><code>ON DELETE SET NULL</code></strong></li>
<li><strong><code>ON DELETE CASCADE</code></strong></li>
<li><strong><code>ON UPDATE RESTRICT</code></strong></li>
<li><strong><code>ON UPDATE SET NULL</code></strong></li>
<li><strong><code>ON UPDATE CASCADE</code></strong></li>
</ul>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Exemple 17</p>
<p><strong>Restriccions per esborrat/actualització de clau externa</strong><br>
Definir una instrucció sobre la taula <strong>localidades</strong> de manera que en eliminar una província s'eliminin totes les localitats d'aquesta província i que no permeti canviar l'identificador de província si té localitats.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-ALTER">ALTER</span> <span class="token keyword keyword-TABLE">TABLE</span> localidades <span class="token keyword keyword-ADD">ADD</span> <span class="token keyword keyword-CONSTRAINT">CONSTRAINT</span> provincias_cod_prov
<span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>cod_provincia<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> provincias <span class="token punctuation">(</span>cod_prov<span class="token punctuation">)</span>
<span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-UPDATE">UPDATE</span> <span class="token keyword keyword-RESTRICT">RESTRICT</span><span class="token punctuation">;</span>
</code></pre></div>
<ul>
<li><strong>SET DEFAULT</strong>: <span style="color:red;">No disponible per a MySQL amb el motor de base de dades InnoDB</span>. Si en la taula pare (<strong>provincias</strong>) s'elimina un registre o s'actualitza la seva clau, si hi ha algun valor de clau externa relacionat en la taula referenciada (<strong>localidades</strong>) s'actualitzarà el valor per defecte de la clau externa.</li>
</ul>
<h3 id="altres-restriccions-i-valors-per-defecte">Altres restriccions i valors per defecte </h3>
<p><strong>Enters positius</strong><br>
En definir un camp podem indicar que només s'acceptaran números positius amb la paraula reservada <strong><code>UNSIGNED</code></strong> i assignar-li un valor per defecte determinat amb la paraula reservada <strong><code>DEFAULT</code></strong> si quan s'insereix un registre no es proporciona un valor per a aquest camp.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 18</p>
<p><strong>Altres restriccions i valors per defecte</strong><br>
En el moment de la creació de la taula <strong>articulos</strong>, definiu el camp <strong><code>precio</code></strong> perquè no pugui acceptar valors negatius i que per defecte valgui 0.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> articulos <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    precio <span class="token keyword keyword-DECIMAL">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword keyword-UNSIGNED">UNSIGNED</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token number">0</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Data d'alta i de modificació</strong><br>
Quan desitgem tenir en una taula la data d'alta i modificació podem utilitzar camps que es creïn i actualitzin automàticament.</p>
<ul>
<li>
<p>Amb <strong>DEFAULT CURRENT_TIMESTAMP</strong> un camp obtindrà per defecte el valor de la data i hora del sistema.</p>
</li>
<li>
<p>Amb <strong>ON UPDATE CURRENT_TIMESTAMP</strong> un camp actualitzarà el valor amb la data i hora del sistema cada vegada que s'actualitzi el registre.</p>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Exemple 19</p>
<p><strong>Altres restriccions i valors per defecte</strong><br>
En el moment de la creació de la taula <strong>ejemplo</strong>, definiu el camp <strong><code>fecha_modificacion</code></strong> perquè s'actualitzi amb el valor de l'instant en què es dugui a terme l'actualització d'un registre i perquè el camp <strong><code>fecha_alta</code></strong> s'ajusti a l'instant actual quan s'insereixi un registre.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> ejemplo <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    fecha_alta <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    fecha_modificacion <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-UPDATE">UPDATE</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Omplir amb zeros</strong><br>
L'ompliment amb zeros a l'esquerra es duu a terme sobre camps de tipus <strong><code>INT</code></strong>. Per a això utilitzem l'opció <strong><code>ZEROFILL</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 20</p>
<p><strong>Altres restriccions i valors per defecte</strong><br>
En el moment de la creació de la taula <strong>ejemplo</strong> definiu el camp <strong><code>codigo</code></strong> perquè s'ompli amb zeros a l'esquerra.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> ejemplo <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> ZEROFILL <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* El valor del codi 1 s'inserirà omplint amb zeros a l'esquerra
per obtenir el valor amb 4 dígits. */</span>
<span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> ejemplo <span class="token punctuation">(</span>codigo<span class="token punctuation">,</span> descripcion<span class="token punctuation">)</span> <span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'registre u'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Clau primària automàtica - Autoincrement</strong><br>
Quan tenim una entitat on emmagatzemem registres però en l'esquema conceptual del model entitat-relació no teníem una clau primària, hem d'afegir un atribut <strong><code>codi</code></strong> (o qualsevol altre nom) per disposar d'una clau primària.</p>
<p>El normal és que aquesta informació no la demanem a l'usuari, ja que en el sistema a analitzar no apareixia aquesta informació, per la qual cosa se sol deixar que sigui el sistema el que generi aquest codi automàticament amb la paraula reservada <strong><code>AUTO_INCREMENT</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 22</p>
<p><strong>Altres restriccions i valors per defecte</strong><br>
Crear la taula <strong>ejemplo</strong> de manera que la clau primària sigui un camp autoincrementat.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> ejemplo <span class="token punctuation">(</span>
    codigo <span class="token keyword keyword-INT">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword keyword-AUTO_INCREMENT">AUTO_INCREMENT</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    descripcion <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- No especifiquem el camp codi ja que aquest és autoincrementat</span>
<span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> ejemplo<span class="token punctuation">(</span>descripcion<span class="token punctuation">)</span> <span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span><span class="token string">'registre u'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>En <strong>phpMyAdmin</strong>, seleccionant la taula i després prement a la pestanya operacions, podem veure i canviar el valor següent de <strong>AUTO_INCREMENT</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Avís</p>
<p>No proporcionar mai valors dels camps autoincrementats en les instruccions d'inserció ja que això ens pot conduir a errors difícils de tractar.</p>
</div>
<h3 id="restriccions-avançades">Restriccions avançades </h3>
<p><strong>Camps calculats</strong><br>
Una solució per als camps calculats és no crear-los en les taules sinó en les consultes amb funcions de MySQL.</p>
<p>Aquest tipus de càlculs i funcions els veurem a la següent unitat didàctica on treballarem el llenguatge de consultes SQL amb les instruccions <strong><code>SELECT</code></strong>.</p>
<p>De totes maneres, per a aquells que desitgin anar practicant, podeu consultar les funcions disponibles a:<br>
<a href="https://dev.mysql.com/doc/refman/8.0/en/func-op-summary-ref.html">https://dev.mysql.com/doc/refman/8.0/en/func-op-summary-ref.html</a></p>
<p><strong>Filtre de valors vàlids</strong><br>
En el llenguatge de SQL existeix la paraula reservada <strong><code>CHECK</code></strong> per indicar la condició que ha de complir un valor d'un camp per ser vàlid.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 23</p>
<p><strong>Restriccions avançades</strong><br>
Crear la taula <strong>notas</strong> de manera que la <strong><code>nota</code></strong> de l'alumne estigui entre 0 i 10.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> notes <span class="token punctuation">(</span>
    nia <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    asignatura <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nota <span class="token keyword keyword-DECIMAL">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-CONSTRAINT">CONSTRAINT</span> check_nota <span class="token keyword keyword-CHECK">CHECK</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>nota <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">AND</span> <span class="token punctuation">(</span>nota <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Transformacions abans de gravar</strong><br>
Igual que en l'apartat anterior <strong><code>CHECK</code></strong> ens permet realitzar aquests canvis.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 24</p>
<p><strong>Restriccions avançades</strong><br>
Desitgem que en el camp <strong><code>asignatura</code></strong> s'emmagatzemin els valors en majúscula independentment de com els proporcioni l'usuari. Per a això utilitzarem la funció <strong><code>UPPER()</code></strong> dins d'una restricció <strong><code>CHECK</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> notas <span class="token punctuation">(</span>
    nia <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    asignatura <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nota <span class="token keyword keyword-DECIMAL">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-CONSTRAINT">CONSTRAINT</span> check_asignatura <span class="token keyword keyword-CHECK">CHECK</span> <span class="token punctuation">(</span> asignatura <span class="token operator">=</span> UPPER<span class="token punctuation">(</span>asignatura<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Encara que aquesta definició no dóna cap error en MySQL, desafortunadament aquesta funcionalitat no està implementada a dia d'avui. El problema es pot solucionar definint un procediment especial anomenat <strong>trigger</strong> o disparador. En una unitat didàctica posterior es tractarà en profunditat el treball amb triggers.<br>
En qualsevol cas, a títol informatiu, es mostrarà el codi d'aquest procediment que en el nostre cas tindrà la funció d'interceptar el valor de l'assignatura que es vol inserir i substituirà el valor proporcionat pel mateix però passat a majúscules.</p>
<div class="admonition example">
<p class="admonition-title">Annex exemple 24</p>
<p><strong>Restriccions avançades</strong><br>
Creació del <strong>trigger</strong> que soluciona el pas a majúscules del nom de les assignatures.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">/* Crear el disparador */</span>
<span class="token keyword keyword-DELIMITER">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TRIGGER">TRIGGER</span> notes_before_insert BEFORE <span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-ON">ON</span> notas
    <span class="token keyword keyword-BEGIN">BEGIN</span>
        <span class="token keyword keyword-FOR EACH ROW">FOR EACH ROW</span> <span class="token keyword keyword-BEGIN">BEGIN</span>
            <span class="token keyword keyword-SET">SET</span> NEW<span class="token punctuation">.</span>asignatura <span class="token operator">=</span> UPPER<span class="token punctuation">(</span>NEW<span class="token punctuation">.</span>asignatura<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-END">END</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-END">END</span> <span class="token comment">//</span>
<span class="token keyword keyword-DELIMITER">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre></div>
<p>Per eliminar un <strong>TRIGGER</strong> disposem de la instrucció <strong><code>DROP</code></strong>.</p>
<div class="admonition example">
<p class="admonition-title">Annex exemple 24b</p>
<p><strong>Restriccions avançades</strong><br>
Eliminar el <strong>trigger</strong> creat a l'exemple anterior.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-DROP">DROP</span> <span class="token keyword keyword-TRIGGER">TRIGGER</span> notas_before_insert<span class="token punctuation">;</span>
</code></pre></div>
<h2 id="taules-a-partir-de-consultes">Taules a partir de consultes </h2>
<p>Hi ha la possibilitat de crear taules a partir de consultes d'altres taules.</p>
<p>La sintaxi és molt senzilla, ja que si tenim una consulta del tipus:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-SELECT">SELECT</span> camp1<span class="token punctuation">,</span> camp2
<span class="token keyword keyword-FROM">FROM</span> nomtaula
<span class="token keyword keyword-WHERE">WHERE</span> condició<span class="token punctuation">;</span>
</code></pre><p>Podríem obtenir una taula amb la següent instrucció SQL:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> novataula
<span class="token keyword keyword-SELECT">SELECT</span> camp1<span class="token punctuation">,</span> camp2 <span class="token keyword keyword-FROM">FROM</span> nomtaula <span class="token keyword keyword-WHERE">WHERE</span> condició<span class="token punctuation">;</span>
</code></pre><p>Però això sí, la crea <strong>sense clau primària, ni restriccions ni índexs</strong>.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p><strong>Taules a partir de consultes</strong><br>
Crear un duplicat de la taula <strong>provincias</strong> de nom <strong>provincias2</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> provincias2
<span class="token keyword keyword-SELECT">SELECT</span> <span class="token operator">*</span> <span class="token keyword keyword-FROM">FROM</span> provincias<span class="token punctuation">;</span>
</code></pre></div>
<h2 id="vistes">Vistes </h2>
<div class="caso_estudio">
<p>Una <strong>vista</strong> és una consulta que es presenta com una taula (virtual) a partir d'un conjunt de taules en una base de dades relacional.</p>
</div> <!-- fi cas d'estudi -->
<p>Les vistes tenen la mateixa estructura que una taula: files i columnes. L'única diferència és que només s'emmagatzema d'elles la definició, no les dades. Les dades que es recuperen mitjançant una consulta a una vista es presentaran igual que les d'una taula. De fet, si no se sap que s'està treballant amb una vista, res fa suposar que és així. Igual que succeeix amb una taula, es poden inserir, actualitzar, esborrar i seleccionar dades en una vista. Encara que sempre és possible seleccionar dades d'una vista, en algunes condicions existeixen restriccions per realitzar la resta de les operacions sobre vistes.</p>
<p>Una vista es especifica a través d'una expressió de consulta (una sentència <strong><code>SELECT</code></strong>) que la calcula i que pot realitzar-se sobre una o més taules. Sobre un conjunt de taules relacionals es pot treballar amb un nombre qualsevol de vistes.</p>
<p>La majoria dels SGBD suporten la creació i manipulació de vistes. La sintaxi és molt senzilla, ja que si tenim una consulta de tipus:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-SELECT">SELECT</span> camp1<span class="token punctuation">,</span> camp2
<span class="token keyword keyword-FROM">FROM</span> nomtaula
<span class="token keyword keyword-WHERE">WHERE</span> condició<span class="token punctuation">;</span>
</code></pre><p>Podríem obtenir una vista amb la sentència <strong><code>CREATE VIEW</code></strong> de la següent manera:</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-VIEW">VIEW</span> novaVista <span class="token keyword keyword-AS">AS</span>
<span class="token keyword keyword-SELECT">SELECT</span> camp1<span class="token punctuation">,</span> camp2
<span class="token keyword keyword-FROM">FROM</span> nomtaula
<span class="token punctuation">[</span><span class="token keyword keyword-WHERE">WHERE</span> condició<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="admonition example">
<p class="admonition-title">Exemple 1</p>
<p><strong>Vistes</strong><br>
Crear una vista de nom <strong>personas1</strong> a partir de la taula <strong>personas</strong> de manera que només contingui les províncies de codi igual a 1.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-VIEW">VIEW</span> personas1 <span class="token keyword keyword-AS">AS</span>
<span class="token keyword keyword-SELECT">SELECT</span> <span class="token operator">*</span> <span class="token keyword keyword-FROM">FROM</span> personas <span class="token keyword keyword-WHERE">WHERE</span> cod_provincia <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div>
<h3 id="vistes-per-aplicar-restriccions">Vistes per aplicar restriccions </h3>
<p>Quan creem una vista d'una taula amb restriccions de tipus <strong><code>CHECK</code></strong>, per defecte, les insercions a la vista no tindran en compte les restriccions. Això es pot solucionar afegint la clàusula <strong><code>WITH CHECK OPTION</code></strong> després de la clàusula <strong><code>WHERE</code></strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-VIEW">VIEW</span> novataula <span class="token keyword keyword-AS">AS</span>
<span class="token keyword keyword-SELECT">SELECT</span> camp1<span class="token punctuation">,</span> camp2
<span class="token keyword keyword-FROM">FROM</span> nomtaula
<span class="token keyword keyword-WHERE">WHERE</span> condició
<span class="token keyword keyword-WITH">WITH</span> <span class="token keyword keyword-CHECK">CHECK</span> <span class="token keyword keyword-OPTION">OPTION</span><span class="token punctuation">;</span>
</code></pre><p>També es pot crear una vista amb restriccions <strong><code>CHECK</code></strong> encara que la taula sobre la qual es realitza no les tingui.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 2</p>
<p><strong>Vistes</strong><br>
Tenim una taula denominada <strong>notas_data</strong></p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> notas_data <span class="token punctuation">(</span>
    nia <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    asignatura <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nota <span class="token keyword keyword-DECIMAL">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Crear una vista sobre aquesta taula amb la restricció de valor de <strong><code>nota</code></strong> entre 0 i 10.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-VIEW">VIEW</span> notas <span class="token keyword keyword-AS">AS</span>
<span class="token keyword keyword-SELECT">SELECT</span> nia<span class="token punctuation">,</span> asignatura<span class="token punctuation">,</span> nota <span class="token keyword keyword-FROM">FROM</span> notas_data <span class="token keyword keyword-WHERE">WHERE</span> <span class="token punctuation">(</span>nota <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>nota <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword keyword-WITH">WITH</span> <span class="token keyword keyword-CHECK">CHECK</span> <span class="token keyword keyword-OPTION">OPTION</span><span class="token punctuation">;</span>
</code></pre></div>
<h3 id="vistes-per-aplicar-transformacions-o-mostrar-camps-calculats">Vistes per aplicar transformacions o mostrar camps calculats </h3>
<p>El següent exemple aclareix aquest concepte.</p>
<div class="admonition example">
<p class="admonition-title">Exemple 3</p>
<p>Suposem que tenim una taula denominada <strong>notas_data</strong></p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> notas <span class="token punctuation">(</span>
    nia <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    asignatura <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nota1 <span class="token keyword keyword-DECIMAL">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nota2 <span class="token keyword keyword-DECIMAL">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Crear una vista que tingui el camp <strong><code>asignatura</code></strong> en majúscules i un camp calculat addicional que sigui la nota mitjana (<strong><code>promedio</code></strong>) de <strong><code>nota1</code></strong> i <strong><code>nota2</code></strong> amb una precisió d'un decimal.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-VIEW">VIEW</span> notas_view <span class="token keyword keyword-AS">AS</span>
<span class="token keyword keyword-SELECT">SELECT</span> nia<span class="token punctuation">,</span> UPPER<span class="token punctuation">(</span>asignatura<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> asignatura_upper<span class="token punctuation">,</span> nota1<span class="token punctuation">,</span> nota2<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nota1<span class="token operator">+</span>nota2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> promedio <span class="token keyword keyword-FROM">FROM</span> notas<span class="token punctuation">;</span>
</code></pre><p>Aquest sistema ens obligaria a editar les dades a la taula <strong>notas</strong> però visualitzar el resultat amb la vista <strong>notas_view</strong>.</p>
</div>
<h3 id="vistes-amb-phpmyadmin">Vistes amb phpMyAdmin </h3>
<p>Un cop hem creat una vista, podrem editar-la si ho desitgem. Per a això, si utilitzem phpMyAdmin, premerem sobre la vista, després a <em>Estructura</em> i posteriorment a <em>Editar vista</em>:<br>
<img src=".img/3.2.png" alt="Edició vista"></p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>